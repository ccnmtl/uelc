{% extends 'base.html' %}
{% block content %}

<div id="content">
    {% for u in user_sections %}
    <!-- user (u.0), gateblocks (u.1) -->
    <h3>Username - {{u.0}} ; type - {{u.0.profile.profile_type}}</h3>
    <ul class="gate_section">
        
        {% for sec in u.1 %}
            <!-- section (sec.0), gateblock (sec.1), unlocked (sec.2), user (sec.3)-->
            {% if sec.2 %}
                <li class="gate-button unlocked">
                    <form>
                      <input value="Lock - {{ sec.1.pageblock.label }}" class="btn btn-primary">
                      <input type="hidden" name="action" value="reset" />
                      <input class="post" type="hidden" value="{{sec.0.get_absolute_url}}"> 
                    </form>
                </li>
            {% else %}
                <li class="gate-button locked">
                    <form>
                     <input value="Unlock - {{ sec.1.pageblock.label }}" class="btn btn-primary">
                     <input type="hidden" name="action" value="submit" />
                     <input class="post" type="hidden" value="{{sec.0.get_absolute_url}}"> 
                    </form>
                </li>
            {% endif %}
        {% endfor %}
    </ul>
    {% endfor %}
</div>

<script>
jQuery(document).ready(function(){
    jQuery('.gate-button').click(function(){
        var form = jQuery(this).children('form');
        var post_elm = form.children('input.post');
        var post_url = post_elm.attr('value');
        
        $.post(post_url, form.serialize());
    })
})
</script>

{% endblock %}